<h3>Test: Present Simple vs Present Continuous</h3>

<div class="box-importante">
    <span class="tag tag-importante">TEST - FORMATO EXAMEN B1</span>
    <p>Este test simula el formato del examen CUID B1. Tienes 10 preguntas.</p>
    <p>Intenta completarlo sin mirar las notas de gramática.</p>
</div>

<div id="testContainer">
    <div class="exercise" data-test="1">
        <div class="exercise-question">
            <p><strong>1.</strong> My brother ________ as a doctor at the local hospital.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) is working</div>
            <div class="exercise-option" data-correct="true">b) works</div>
            <div class="exercise-option" data-correct="false">c) work</div>
            <div class="exercise-option" data-correct="false">d) does work</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="2">
        <div class="exercise-question">
            <p><strong>2.</strong> Be quiet! The baby ________.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) sleeps</div>
            <div class="exercise-option" data-correct="true">b) is sleeping</div>
            <div class="exercise-option" data-correct="false">c) sleep</div>
            <div class="exercise-option" data-correct="false">d) does sleep</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="3">
        <div class="exercise-question">
            <p><strong>3.</strong> I ________ what you mean. Can you explain again?</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="true">a) don't understand</div>
            <div class="exercise-option" data-correct="false">b) am not understanding</div>
            <div class="exercise-option" data-correct="false">c) not understand</div>
            <div class="exercise-option" data-correct="false">d) doesn't understand</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="4">
        <div class="exercise-question">
            <p><strong>4.</strong> The sun ________ in the east and sets in the west.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) is rising</div>
            <div class="exercise-option" data-correct="true">b) rises</div>
            <div class="exercise-option" data-correct="false">c) rise</div>
            <div class="exercise-option" data-correct="false">d) rising</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="5">
        <div class="exercise-question">
            <p><strong>5.</strong> What ________ this weekend? Any plans?</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) do you do</div>
            <div class="exercise-option" data-correct="true">b) are you doing</div>
            <div class="exercise-option" data-correct="false">c) you do</div>
            <div class="exercise-option" data-correct="false">d) you are doing</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="6">
        <div class="exercise-question">
            <p><strong>6.</strong> She ________ three languages: English, Spanish and French.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) is speaking</div>
            <div class="exercise-option" data-correct="true">b) speaks</div>
            <div class="exercise-option" data-correct="false">c) speak</div>
            <div class="exercise-option" data-correct="false">d) speaking</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="7">
        <div class="exercise-question">
            <p><strong>7.</strong> I can't come to the phone. I ________ dinner.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) cook</div>
            <div class="exercise-option" data-correct="true">b) am cooking</div>
            <div class="exercise-option" data-correct="false">c) cooks</div>
            <div class="exercise-option" data-correct="false">d) cooked</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="8">
        <div class="exercise-question">
            <p><strong>8.</strong> How often ________ to the gym?</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="true">a) do you go</div>
            <div class="exercise-option" data-correct="false">b) are you going</div>
            <div class="exercise-option" data-correct="false">c) you go</div>
            <div class="exercise-option" data-correct="false">d) goes you</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="9">
        <div class="exercise-question">
            <p><strong>9.</strong> This cheese ________ strange. Is it still good?</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) is smelling</div>
            <div class="exercise-option" data-correct="true">b) smells</div>
            <div class="exercise-option" data-correct="false">c) smell</div>
            <div class="exercise-option" data-correct="false">d) smelling</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>

    <div class="exercise" data-test="10">
        <div class="exercise-question">
            <p><strong>10.</strong> They ________ in Madrid at the moment. They moved there last month.</p>
        </div>
        <div class="exercise-options">
            <div class="exercise-option" data-correct="false">a) live</div>
            <div class="exercise-option" data-correct="true">b) are living</div>
            <div class="exercise-option" data-correct="false">c) lives</div>
            <div class="exercise-option" data-correct="false">d) living</div>
        </div>
        <div class="exercise-feedback"></div>
    </div>
</div>

<div class="test-results" id="testResults" style="display: none;">
    <h4>Tu resultado</h4>
    <div class="test-score" id="testScore">0/10</div>
    <p id="testMessage"></p>
    <button class="tab-btn" onclick="location.reload()" style="margin-top: 15px;">Repetir Test</button>
</div>

<div class="box-complementario">
    <span class="tag tag-complementario">DESPUÉS DEL TEST</span>
    <p>Revisa tus errores. Si tienes dudas, pregunta al tutor en el chat.</p>
    <p>Ejemplo: <em>"Why is 'smells' correct in question 9?"</em></p>
</div>

<script>
// Test logic
document.addEventListener('DOMContentLoaded', function() {
    const exercises = document.querySelectorAll('[data-test]');
    let answered = 0;
    let correct = 0;

    exercises.forEach(exercise => {
        const options = exercise.querySelectorAll('.exercise-option');
        options.forEach(option => {
            option.addEventListener('click', function() {
                if (exercise.classList.contains('answered')) return;

                exercise.classList.add('answered');
                answered++;

                const isCorrect = this.dataset.correct === 'true';
                if (isCorrect) {
                    this.classList.add('correct');
                    correct++;
                } else {
                    this.classList.add('incorrect');
                    // Show correct answer
                    options.forEach(opt => {
                        if (opt.dataset.correct === 'true') {
                            opt.classList.add('correct');
                        }
                    });
                }

                // Check if test is complete
                if (answered === exercises.length) {
                    showResults();
                }
            });
        });
    });

    function showResults() {
        const resultsDiv = document.getElementById('testResults');
        const scoreDiv = document.getElementById('testScore');
        const messageP = document.getElementById('testMessage');

        const percentage = (correct / exercises.length) * 100;
        scoreDiv.textContent = `${correct}/${exercises.length} (${percentage}%)`;

        if (percentage >= 90) {
            scoreDiv.className = 'test-score excellent';
            messageP.textContent = 'Excellent! You have mastered this topic.';
        } else if (percentage >= 70) {
            scoreDiv.className = 'test-score good';
            messageP.textContent = 'Good job! Review the questions you got wrong.';
        } else if (percentage >= 50) {
            scoreDiv.className = 'test-score needs-work';
            messageP.textContent = 'You need more practice. Review the grammar section.';
        } else {
            scoreDiv.className = 'test-score poor';
            messageP.textContent = 'Review the grammar section and try again.';
        }

        resultsDiv.style.display = 'block';
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
    }
});
</script>
